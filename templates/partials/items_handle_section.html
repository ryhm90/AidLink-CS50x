{% if emp %}
<div class="card bg-light p-3 mb-3">
  <div class="row small">
    <div class="col-md-4 mb-2"><strong>ุงูุงุณู:</strong> {{ emp.name }}<br><strong>ููุน ุงูุนูู:</strong> {{ emp.type_work }}</div>
    <div class="col-md-4 mb-2"><strong>ุงูุฌูุณ:</strong> {{ emp.six_type }}<br><strong>ุงูุญุงูุฉ ุงูุงุฌุชูุงุนูุฉ:</strong> {{ emp.mared }}<br><strong>ูููุน ุงูุนูู:</strong> {{ emp.locat_na }}</div>
    <div class="col-md-4 mb-2"><strong>ุชุงุฑูุฎ ุงูุชุนููู:</strong> {{ emp.date1 }}<br><strong>ุงูุนููุงู:</strong> {{ emp.addres }}</div>
  </div>
  <div class="text-center mt-2">
    <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#additemsModal">โ ุฅุถุงูุฉ</button>
  </div>
</div>

<!-- ุฌุฏูู ุงูููุงุฏ -->
<div class="table-responsive">
  <div style="overflow-x:auto;">
    <div style="overflow-x: auto; max-height: 350px;">
    <table class="table table-bordered text-center small table-hover">
      <thead class="table-light">
  <tr>
    <th>ุงููุงุฏุฉ</th>
    <th>ุชุงุฑูุฎ ุงูุชุณููู</th>
    <th>ุฅุฌุฑุงุก</th>
  </tr>
</thead>
    <tbody>
      {% for i in items %}
      <tr>
        <td>{{ i.moad_name }}</td>
        <td>{{ i.date_astlam }}</td>
        <td>    
       
            <a href="#" class="text-danger" data-bs-toggle="modal" data-bs-target="#deleteitemsModal_{{ i.id }}">
                <i class="bi bi-trash fs-5"></i>
              </a>
            <!-- Modal ุญุฐู -->
<div class="modal fade" id="deleteitemsModal_{{ i.id }}" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <form class="modal-content" id="deleteitemsForm" onsubmit="event.preventDefault(); deleteitems('{{ i.id }}');">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <input type="hidden" name="offi_no" value="{{ emp.nono }}">
        <input type="hidden" name="id" value="{{ i.id }}">
        <div class="modal-header bg-danger text-white">
          <h5 class="modal-title">๐ ุญุฐู ุงููุงุฏุฉ</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐู ุงููุงุฏุฉุ</div>
        <div class="modal-footer">
          <button type="submit" class="btn btn-danger">ูุนู</button>
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ุฅูุบุงุก</button>
        </div>
      </form>
    </div>
  </div>
</td>
</tr>
      {% else %}
      <tr><td colspan="3">ูุง ุชูุฌุฏ ููุงุฏ ูุณุชููุฉ</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% if total is defined %}
{% set total_pages = (total // per_page) + (1 if total % per_page else 0) %}
{% set visible_pages = 2 %}
{% set middle_range = 2 %}

{% if total_pages > 1 %}
<nav aria-label="Page navigation">
<ul class="pagination justify-content-center mt-4">

<!-- ุฃูู ุตูุญุชูู -->
{% for p in range(1, visible_pages + 1) %}
  {% if p <= total_pages %}
  <li class="page-item {% if p == page %}active{% endif %}">
    <a class="page-link" href="{{ url_for('items_handle_page', page=p, nono=nono) }}">{{ p }}</a>

  </li>
  {% endif %}
{% endfor %}

{% if page > visible_pages + middle_range + 1 and total_pages > visible_pages * 2 %}
  <li class="page-item disabled"><span class="page-link">...</span></li>
{% endif %}

<!-- ุตูุญุงุช ุญูู ุงูุตูุญุฉ ุงูุญุงููุฉ -->
{% for p in range(page - middle_range, page + middle_range + 1) %}
  {% if p > visible_pages and p < total_pages - visible_pages + 1 %}
    <li class="page-item {% if p == page %}active{% endif %}">
      <a class="page-link" href="{{ url_for('items_handle_page', page=p, nono=nono) }}">{{ p }}</a>
    </li>
  {% endif %}
{% endfor %}

{% if page < total_pages - visible_pages - middle_range and total_pages > visible_pages * 2 %}
  <li class="page-item disabled"><span class="page-link">...</span></li>
{% endif %}

<!-- ุขุฎุฑ ุตูุญุชูู -->
{% for p in range(total_pages - visible_pages + 1, total_pages + 1) %}
  {% if p > visible_pages %}
  <li class="page-item {% if p == page %}active{% endif %}">
    <a class="page-link" href="{{ url_for('items_handle_page', page=p, nono=nono) }}">{{ p }}</a>
  </li>
  {% endif %}
{% endfor %}

</ul>
</nav>
{% endif %}
{% endif %}
</div>

<!-- Modal ุงูุฅุถุงูุฉ -->
<div class="modal fade" id="additemsModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <form class="modal-content" id="additemsForm" onsubmit="event.preventDefault(); saveitems();">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
      <input type="hidden" name="offi_no" value="{{ emp.nono }}">
      <input type="hidden" name="offi_name" value="{{ emp.name }}">
      <input type="hidden" name="offi_addres" value="{{ emp.addres }}">
      <input type="hidden" name="offi_cost_name" value="{{ emp.locat_na }}">
      <input type="hidden" name="offi_cost_no" value="{{ emp.locat_no }}">
      <div class="modal-header bg-success text-white">
        <h5 class="modal-title">โ ุชุณููู ูุงุฏุฉ</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <div class="mb-2">
          <label>ุงุณู ุงููุงุฏุฉ</label>
          <select name="moad_name" class="form-select" required>
            {% for m in moads %}
            <option value="{{ m.name }}">{{ m.name }}</option>
            {% endfor %}
          </select>
        </div>
        <div class="mb-2">
          <label>ุชุงุฑูุฎ ุงูุชุณููู</label>
          <input type="date" name="date_astlam" class="form-control" required>
        </div>
      </div>
      <div class="modal-footer">
        <button type="submit" class="btn btn-success">ุชุณููู</button>
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ุฅูุบุงุก</button>
      </div>
    </form>
  </div>
</div>
{% endif %}
