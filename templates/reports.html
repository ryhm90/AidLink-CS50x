{% extends "layout.html" %}
{% block title %}ØµÙØ­Ø© Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±{% endblock %}
{% block main %}
<script>
  var csrfToken = "{{ csrf_token() }}";
</script>

<h4 class="mb-4">ğŸ“Š Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</h4>

<form id="reportForm" class="mb-4" onsubmit="event.preventDefault(); loadReport();">
  <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
  <div class="row g-3">
    <div class="col-md-4">
      <label for="nono" class="form-label">Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¸Ù</label>
      <input type="text" name="nono" class="form-control" placeholder="Ø§Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¸Ù">
    </div>
    <div class="col-md-4">
      <label for="from_date" class="form-label">Ù…Ù† ØªØ§Ø±ÙŠØ®</label>
      <input type="date" name="from_date" class="form-control">
    </div>
    <div class="col-md-4">
      <label for="to_date" class="form-label">Ø¥Ù„Ù‰ ØªØ§Ø±ÙŠØ®</label>
      <input type="date" name="to_date" class="form-control">
    </div>
    <div class="col-md-12 mt-3">
      <button type="submit" name="report_type" value="checkup_detail" class="btn btn-outline-primary" onclick="setType(this)">ğŸ“„ ÙØ­Øµ Ù…ÙˆØ¸Ù</button>
      <button type="submit" name="report_type" value="checkup_all" class="btn btn-outline-primary" onclick="setType(this)">ğŸ“„ ÙØ­ÙˆØµØ§Øª Ø§Ù„Ø¬Ù…ÙŠØ¹</button>
      <button type="submit" name="report_type" value="help_detail" class="btn btn-outline-success" onclick="setType(this)">ğŸ’° Ù…Ø³Ø§Ø¹Ø¯Ø§Øª Ù…ÙˆØ¸Ù</button>
      <button type="submit" name="report_type" value="help_all" class="btn btn-outline-success" onclick="setType(this)">ğŸ’° Ù…Ø³Ø§Ø¹Ø¯Ø§Øª Ø§Ù„Ø¬Ù…ÙŠØ¹</button>
      <button type="submit" name="report_type" value="items_detail" class="btn btn-outline-dark" onclick="setType(this)">ğŸ› ï¸ Ù…Ø¹Ø¯Ø§Øª Ù…ÙˆØ¸Ù</button>
      <button type="submit" name="report_type" value="items_all" class="btn btn-outline-dark" onclick="setType(this)">ğŸ› ï¸ Ù…Ø¹Ø¯Ø§Øª Ø§Ù„Ø¬Ù…ÙŠØ¹</button>
    </div>
  </div>
</form>

<div id="report_section">{% include "partials/report_section.html" %}</div>

<script>
  let selectedType = "";

  function setType(button) {
    selectedType = button.value;
  }

  async function loadReport() {
    const form = document.getElementById("reportForm");
    const formData = new FormData(form);
    formData.set("report_type", selectedType);

    const response = await fetch("/reports", {
      method: "POST",
      body: formData,
    });

    const html = await response.text();
    document.getElementById("report_section").innerHTML = html;
  }
</script>
{% endblock %}
